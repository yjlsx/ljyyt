<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>视频播放 - 丽江音悦台</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    body {
      background: #f8f9fa;
      color: #333;
    }
    .video-container {
      background: #000;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .video-player {
      width: 100%;
      height: auto;
      display: block;
    }
    .video-info {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .related-video-card {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .related-video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    .related-thumbnail {
      width: 100%;
      height: 120px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <!-- 导航栏 -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="./images/avatar.jpg" alt="丽江音悦台" width="40" height="40" class="rounded-circle me-2">
        丽江音悦台
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">首页</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#about">关于我们</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#contact">联系我们</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 视频播放区域 -->
  <div class="container py-5 mt-5">
    <div class="row">
      <!-- 主视频播放器 -->
      <div class="col-lg-8">
        <div class="video-container">
          <video id="main-video" class="video-player" controls poster="">
            <source src="" type="video/mp4">
            您的浏览器不支持视频播放。
          </video>
        </div>
        
        <!-- 视频信息 -->
        <div class="video-info">
          <h2 id="video-title">视频标题</h2>
          <p class="text-muted mb-2">
            <i class="fas fa-user me-2"></i>
            <span id="video-artist">艺术家</span>
          </p>
          <p class="text-muted mb-0">
            <i class="fas fa-clock me-2"></i>
            <span id="video-duration">时长</span>
          </p>
          <p class="mt-3" id="video-description">视频描述</p>
        </div>
      </div>
      
      <!-- 相关视频推荐 -->
      <div class="col-lg-4">
        <h4 class="mb-4">
          <i class="fas fa-video me-2"></i>相关视频
        </h4>
        <div id="related-videos">
          <!-- 相关视频将通过JavaScript动态生成 -->
        </div>
      </div>
    </div>
  </div>

  <!-- 页脚 -->
  <footer class="bg-dark text-white py-4 mt-5">
    <div class="container text-center">
      <p>&copy; 2026 丽江音悦台. 保留所有权利.</p>
      <p>传承纳西文化，分享民族音乐之美</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- 视频数据 -->
  <script src="videos/video_data.js"></script>
  
  <script>
    // videoData 已从 videos/video_data.js 加载
    let currentVideoIndex = 0;

    // 格式化时间
    function formatTime(seconds) {
      if(isNaN(seconds) || seconds <= 0) return '0:00';
      const min = Math.floor(seconds / 60);
      const sec = Math.floor(seconds % 60);
      return min + ':' + (sec < 10 ? '0' : '') + sec;
    }

    // 加载视频
    function loadVideo(index) {
      const video = videoData[index];
      const videoPlayer = document.getElementById('main-video');
      
      currentVideoIndex = index;
      
      videoPlayer.src = video.src;
      videoPlayer.poster = video.cover;
      
      document.getElementById('video-title').textContent = video.title;
      document.getElementById('video-artist').textContent = video.artist;
      document.getElementById('video-duration').textContent = formatTime(video.duration);
      document.getElementById('video-description').textContent = video.description || '暂无描述';
      
      // 更新相关视频列表
      renderRelatedVideos();
      
      // 自动播放
      videoPlayer.play().catch(function(error) {
        console.log('自动播放被阻止:', error);
      });
    }

    // 渲染相关视频
    function renderRelatedVideos() {
      const container = document.getElementById('related-videos');
      container.innerHTML = '';
      
      videoData.forEach(function(video, index) {
        if (index === currentVideoIndex) return; // 跳过当前视频
        
        const card = document.createElement('div');
        card.className = 'related-video-card mb-3';
        card.innerHTML = 
          '<img src="' + video.cover + '" alt="' + video.title + '" class="related-thumbnail">' +
          '<div class="p-3">' +
            '<h6 class="mb-1">' + video.title + '</h6>' +
            '<p class="text-muted mb-0 small">' + video.artist + '</p>' +
            '<small class="text-muted">时长: ' + formatTime(video.duration) + '</small>' +
          '</div>';
        
        card.addEventListener('click', function() {
          loadVideo(index);
        });
        
        container.appendChild(card);
      });
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 从URL参数获取视频ID
      const urlParams = new URLSearchParams(window.location.search);
      const videoId = urlParams.get('id');
      
      if (videoId) {
        const index = videoData.findIndex(function(v) {
          return v.id === parseInt(videoId);
        });
        if (index !== -1) {
          loadVideo(index);
        } else {
          loadVideo(0);
        }
      } else {
        loadVideo(0);
      }
    });
  </script>
</body>
</html>